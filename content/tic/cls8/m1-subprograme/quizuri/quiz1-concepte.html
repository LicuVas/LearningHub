<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz: Conceptul de functie | Clasa 8</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f0f1a;
            --bg-secondary: #1a1a2e;
            --bg-card: #252540;
            --accent-red: #ef4444;
            --accent-rose: #f43f5e;
            --accent-green: #10b981;
            --accent-cyan: #06b6d4;
            --accent-yellow: #fbbf24;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #3d3d5c;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        /* Header with XP */
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-radius: 16px;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
        }

        .quiz-title {
            font-size: 1.3rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-red), var(--accent-rose));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .xp-display {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, var(--accent-red), var(--accent-rose));
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            color: #fff;
        }

        /* Level Map */
        .level-map {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .level-node {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            border: 3px solid var(--border);
            background: var(--bg-card);
        }

        .level-node.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .level-node.locked::after {
            content: 'üîí';
            position: absolute;
            font-size: 1rem;
            bottom: -5px;
            right: -5px;
        }

        .level-node.active {
            border-color: var(--accent-red);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
            animation: pulse 2s infinite;
        }

        .level-node.completed {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
            border-color: var(--accent-green);
        }

        .level-node.completed::after {
            content: '‚úì';
            position: absolute;
            font-size: 0.8rem;
            bottom: -5px;
            right: -5px;
            background: var(--accent-green);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Level connector line */
        .level-connector {
            width: 30px;
            height: 3px;
            background: var(--border);
            align-self: center;
        }

        .level-connector.completed {
            background: var(--accent-green);
        }

        /* Quiz Area */
        .quiz-area {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid var(--border);
            min-height: 400px;
        }

        .level-intro {
            text-align: center;
            padding: 2rem;
        }

        .level-intro h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--accent-red);
        }

        .level-intro p {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .level-intro .xp-reward {
            display: inline-block;
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            margin-bottom: 2rem;
        }

        /* Question styles */
        .question-container {
            display: none;
        }

        .question-container.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .question-progress {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--border);
        }

        .progress-dot.current {
            background: var(--accent-red);
        }

        .progress-dot.correct {
            background: var(--accent-green);
        }

        .progress-dot.wrong {
            background: var(--accent-rose);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            text-align: center;
            line-height: 1.6;
        }

        /* Code block styling */
        .code-block {
            background: #1e1e3a;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            margin: 1rem auto;
            max-width: 500px;
            text-align: left;
            border: 2px solid var(--border);
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 1rem;
            color: #e2e8f0;
            overflow-x: auto;
        }

        .code-block .keyword {
            color: #c586c0;
        }

        .code-block .type {
            color: #4ec9b0;
        }

        .code-block .number {
            color: #b5cea8;
        }

        .code-block .string {
            color: #ce9178;
        }

        .code-block .comment {
            color: #6a9955;
        }

        .code-block .function {
            color: #dcdcaa;
        }

        /* Answer options */
        .options-grid {
            display: grid;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .option {
            padding: 1.2rem 1.5rem;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
            text-align: left;
        }

        .option:hover {
            border-color: var(--accent-rose);
            transform: translateX(5px);
        }

        .option.selected {
            border-color: var(--accent-cyan);
            background: rgba(6, 182, 212, 0.1);
        }

        .option.correct {
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.2);
        }

        .option.wrong {
            border-color: var(--accent-rose);
            background: rgba(244, 63, 94, 0.2);
        }

        /* Feedback */
        .feedback-box {
            display: none;
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 1.5rem;
            text-align: center;
        }

        .feedback-box.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .feedback-box.correct {
            background: rgba(16, 185, 129, 0.2);
            border: 2px solid var(--accent-green);
        }

        .feedback-box.wrong {
            background: rgba(244, 63, 94, 0.2);
            border: 2px solid var(--accent-rose);
        }

        .feedback-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .feedback-text {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .explanation {
            font-size: 0.95rem;
            color: var(--text-secondary);
            background: var(--bg-card);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            text-align: left;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-red), var(--accent-rose));
            color: white;
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-secondary);
        }

        .btn-outline:hover {
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        /* Level complete screen */
        .level-complete {
            display: none;
            text-align: center;
            padding: 3rem;
        }

        .level-complete.show {
            display: block;
            animation: celebrate 0.5s ease;
        }

        @keyframes celebrate {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .level-complete-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        .level-complete h2 {
            font-size: 2rem;
            color: var(--accent-green);
            margin-bottom: 1rem;
        }

        .xp-earned {
            font-size: 2rem;
            color: var(--accent-red);
            margin: 1.5rem 0;
        }

        .score-display {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .stars {
            font-size: 3rem;
            margin: 1rem 0;
        }

        /* Back link */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .back-link:hover {
            color: var(--accent-cyan);
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container { padding: 1rem; }
            .quiz-header { flex-direction: column; gap: 1rem; }
            .level-node { width: 50px; height: 50px; font-size: 1.2rem; }
            .question-text { font-size: 1.1rem; }
            .code-block { font-size: 0.85rem; padding: 0.8rem; }
        }

        footer {
            margin-top: 3rem;
            padding: 1.5rem;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.85rem;
            border-top: 1px solid var(--border);
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">‚Üê Inapoi la Modulul 1</a>

        <div class="quiz-header">
            <div class="quiz-title">Quiz: Conceptul de functie</div>
            <div class="xp-display">
                <span>XP:</span>
                <span id="totalXP">0</span>
            </div>
        </div>

        <!-- Level Map -->
        <div class="level-map">
            <div class="level-node active" data-level="1" onclick="selectLevel(1)">1</div>
            <div class="level-connector"></div>
            <div class="level-node locked" data-level="2" onclick="selectLevel(2)">2</div>
            <div class="level-connector"></div>
            <div class="level-node locked" data-level="3" onclick="selectLevel(3)">3</div>
            <div class="level-connector"></div>
            <div class="level-node locked" data-level="4" onclick="selectLevel(4)">4</div>
            <div class="level-connector"></div>
            <div class="level-node locked" data-level="5" onclick="selectLevel(5)">5</div>
        </div>

        <!-- Quiz Area -->
        <div class="quiz-area" id="quizArea">
            <!-- Level intro will be shown here -->
        </div>
    </div>

    <footer>
        <strong>&copy; 2026 Prof. Gurlan Vasile</strong><br>
        Informatica si TIC | <a href="mailto:grlnvasile@gmail.com" style="color: var(--accent-cyan);">grlnvasile@gmail.com</a>
    </footer>

    <script>
        // Quiz data for each level
        const levels = {
            1: {
                title: "Nivel 1: Ce este o functie?",
                description: "Descopera conceptul fundamental de subprogram",
                xpReward: 50,
                questions: [
                    {
                        text: "Ce este o functie (subprogram) in programare?",
                        options: [
                            "O variabila care stocheaza mai multe valori",
                            "Un bloc de cod care realizeaza o sarcina specifica si poate fi refolosit",
                            "Un tip de bucla pentru repetitii",
                            "O eroare in program"
                        ],
                        correct: 1,
                        explanation: "O functie este un bloc de instructiuni grupate impreuna care realizeaza o sarcina specifica. Odata scrisa, functia poate fi apelata (folosita) de mai multe ori in program, fara a rescrie codul."
                    },
                    {
                        text: "Care dintre urmatoarele NU este un avantaj al folosirii functiilor?",
                        options: [
                            "Codul devine mai organizat si mai usor de citit",
                            "Putem refolosi acelasi cod de mai multe ori",
                            "Programul devine mai lung si mai complicat",
                            "Este mai usor de gasit si reparat erorile"
                        ],
                        correct: 2,
                        explanation: "Functiile fac programul MAI SCURT si MAI SIMPLU, nu mai lung! In loc sa scriem acelasi cod de 10 ori, scriem o functie o data si o apelam de 10 ori. Codul devine mai organizat, mai usor de inteles si de depanat."
                    },
                    {
                        text: "Ce functie folosesti deja in toate programele C++?",
                        hasCode: true,
                        codeContent: '<span class="type">int</span> <span class="function">main</span>() {\n    <span class="comment">// codul tau aici</span>\n    <span class="keyword">return</span> <span class="number">0</span>;\n}',
                        options: [
                            "Functia printf()",
                            "Functia main() - punctul de start al programului",
                            "Functia start()",
                            "Functia run()"
                        ],
                        correct: 1,
                        explanation: "Functia main() este functia principala din orice program C++. Executia programului incepe intotdeauna de la main(). Este prima functie pe care ai invatat-o, chiar daca nu stiai ca este o functie!"
                    }
                ]
            },
            2: {
                title: "Nivel 2: De ce folosim functii?",
                description: "Intelege avantajele modularizarii codului",
                xpReward: 75,
                questions: [
                    {
                        text: "Ce inseamna 'modularizarea' unui program?",
                        options: [
                            "A face programul sa ruleze mai incet",
                            "A imparti programul in parti mai mici (module/functii) care rezolva fiecare o problema specifica",
                            "A sterge parti din program",
                            "A adauga mai multe variabile"
                        ],
                        correct: 1,
                        explanation: "Modularizarea inseamna a imparti un program mare in bucati mai mici (functii/module). Fiecare functie rezolva o problema specifica. E ca un puzzle: fiecare piesa are rolul ei, iar impreuna formeaza imaginea completa."
                    },
                    {
                        text: "Daca ai nevoie sa calculezi aria unui dreptunghi de 5 ori in program, ce varianta este mai buna?",
                        options: [
                            "Scrii formula lungime * latime de 5 ori in cod",
                            "Creezi o functie calculeazaArie() si o apelezi de 5 ori",
                            "Folosesti 5 variabile diferite",
                            "Nu se poate calcula de 5 ori"
                        ],
                        correct: 1,
                        explanation: "Functia este solutia perfecta! O scrii O SINGURA DATA si o apelezi de cate ori ai nevoie. Daca trebuie sa modifici formula, o faci intr-un singur loc. Fara functie, ai modifica in 5 locuri diferite si ai putea gresi."
                    },
                    {
                        text: "Principiul 'DRY' (Don't Repeat Yourself) inseamna:",
                        options: [
                            "Sa nu folosesti variabile",
                            "Sa eviti repetarea aceluiasi cod - foloseste functii pentru cod repetitiv",
                            "Sa nu scrii comentarii",
                            "Sa nu testezi programul"
                        ],
                        correct: 1,
                        explanation: "DRY = 'Nu te repeta!' Este unul dintre cele mai importante principii in programare. Daca scrii acelasi cod de 2+ ori, ar trebui sa-l pui intr-o functie. Asa codul e mai scurt, mai clar si mai usor de modificat."
                    }
                ]
            },
            3: {
                title: "Nivel 3: Exemple din viata reala",
                description: "Analogii cu lumea reala pentru a intelege functiile",
                xpReward: 100,
                questions: [
                    {
                        text: "O reteta de gatit seamana cu o functie pentru ca:",
                        options: [
                            "Ambele sunt lungi si complicate",
                            "Ambele sunt instructiuni pas cu pas pe care le poti folosi de cate ori vrei",
                            "Ambele necesita un calculator",
                            "Nu exista nicio asemanare"
                        ],
                        correct: 1,
                        explanation: "O reteta este ca o functie! Are un NUME (Clatite), INGREDIENTE (parametri), PASI de urmat (codul functiei) si un REZULTAT (clatitele gatite). O poti folosi de cate ori vrei pentru a obtine acelasi rezultat."
                    },
                    {
                        text: "In ce situatie din viata reala ai folosi 'functii' (actiuni predefinite)?",
                        options: [
                            "Cand faci ceva o singura data si nu mai repeti niciodata",
                            "Cand inveti sa mergi pe bicicleta - odata invatat, aplici aceeasi tehnica mereu",
                            "Cand uiti cum sa faci ceva",
                            "Cand nu vrei sa faci nimic"
                        ],
                        correct: 1,
                        explanation: "Exact! Odata ce ai 'programat' creierul sa mearga pe bicicleta, poti 'apela' aceasta abilitate oricand. Similar, scriem o functie o data si o folosim de cate ori avem nevoie, fara a reinvata/rescrie totul."
                    },
                    {
                        text: "Un calculator de buzunar are butoane pentru operatii (+, -, *, /). Fiecare buton este ca:",
                        options: [
                            "O variabila",
                            "O functie - apesi butonul si executa o operatie predefinita",
                            "Un program separat",
                            "O eroare"
                        ],
                        correct: 1,
                        explanation: "Fiecare buton de pe calculator apeleaza o 'functie' interna! Cand apesi '+', calculatorul executa functia de adunare. Nu trebuie sa stii cum functioneaza intern - doar apesi si obtii rezultatul. Asta e puterea functiilor!"
                    }
                ]
            },
            4: {
                title: "Nivel 4: Beneficiile functiilor",
                description: "Intelege de ce functiile sunt esentiale in programare profesionala",
                xpReward: 125,
                questions: [
                    {
                        text: "De ce este mai usor sa gasesti erori intr-un program cu functii?",
                        options: [
                            "Functiile ascund erorile",
                            "Poti testa fiecare functie separat si izola problema mai usor",
                            "Functiile nu pot avea erori",
                            "Erorile dispar automat"
                        ],
                        correct: 1,
                        explanation: "Cu functii, poti testa fiecare bucata de cod separat. Daca functia calculeazaMedie() da rezultat gresit, stii exact unde e problema. Fara functii, ai cauta in sute de linii de cod amestecat. Functiile fac debugging-ul mult mai usor!"
                    },
                    {
                        text: "Intr-un proiect cu mai multi programatori, functiile ajuta pentru ca:",
                        options: [
                            "Doar un programator poate scrie cod",
                            "Fiecare poate lucra la functii diferite simultan, fara a interfera",
                            "Functiile fac codul secret",
                            "Nu exista niciun beneficiu"
                        ],
                        correct: 1,
                        explanation: "In echipe, functiile permit munca in paralel! Ana lucreaza la functia salveazaFisier(), Mihai la functia calculeazaPret(). Cand termina, le combina. Fara functii, ar lucra amandoi pe acelasi cod si ar crea conflicte."
                    },
                    {
                        text: "Ce inseamna ca o functie este o 'cutie neagra'?",
                        options: [
                            "Functia trebuie scrisa cu font negru",
                            "Utilizatorul functiei nu trebuie sa stie cum functioneaza intern, doar ce primeste si ce returneaza",
                            "Functia nu are parametri",
                            "Functia este ascunsa in cod"
                        ],
                        correct: 1,
                        explanation: "Conceptul de 'cutie neagra' inseamna ca poti folosi o functie fara sa stii exact cum e implementata. Stii ca sqrt(9) returneaza 3, dar nu trebuie sa stii algoritmul matematic intern. Asta permite reutilizarea si simplifica gandirea."
                    }
                ]
            },
            5: {
                title: "Nivel 5: Functii in C++",
                description: "Pregateste-te pentru a scrie propriile functii",
                xpReward: 150,
                questions: [
                    {
                        text: "Care sunt partile principale ale unei functii?",
                        hasCode: true,
                        codeContent: '<span class="type">int</span> <span class="function">aduna</span>(<span class="type">int</span> a, <span class="type">int</span> b) {\n    <span class="keyword">return</span> a + b;\n}',
                        options: [
                            "Doar numele functiei",
                            "Tipul returnat, numele, parametrii si corpul functiei",
                            "Doar parametrii",
                            "Doar instructiunea return"
                        ],
                        correct: 1,
                        explanation: "O functie are 4 parti: 1) TIP RETURNAT (int - ce tip de valoare returneaza), 2) NUME (aduna), 3) PARAMETRI (int a, int b - ce date primeste), 4) CORP ({...} - codul care se executa). Vom studia fiecare in detaliu!"
                    },
                    {
                        text: "Ce face functia cout << pow(2, 3); daca pow() calculeaza puterea?",
                        options: [
                            "Afiseaza 6 (2 * 3)",
                            "Afiseaza 8 (2 la puterea 3)",
                            "Afiseaza 5 (2 + 3)",
                            "Da eroare"
                        ],
                        correct: 1,
                        explanation: "pow(2, 3) este o functie din biblioteca cmath care calculeaza 2^3 = 8. Observa cum functia primeste 2 parametri (baza si exponentul) si returneaza rezultatul. Nu trebuie sa scrii tu formula, doar apelezi functia!"
                    },
                    {
                        text: "De ce functia main() are 'int' in fata?",
                        hasCode: true,
                        codeContent: '<span class="type">int</span> <span class="function">main</span>() {\n    <span class="comment">// cod</span>\n    <span class="keyword">return</span> <span class="number">0</span>;\n}',
                        options: [
                            "E doar decorativ",
                            "Pentru ca main() returneaza un numar intreg sistemului de operare (0 = succes)",
                            "Pentru ca main() primeste un numar",
                            "Este o greseala de sintaxa"
                        ],
                        correct: 1,
                        explanation: "main() returneaza un int (numar intreg) sistemului de operare. 'return 0' inseamna 'programul s-a terminat cu succes'. Alte valori indica erori. Asa, sistemul de operare stie daca programul a rulat corect."
                    }
                ]
            }
        };

        let currentLevel = 1;
        let currentQuestion = 0;
        let score = 0;
        let totalXP = 0;
        let levelScores = {};
        let unlockedLevels = [1];

        // Load saved progress
        function loadProgress() {
            const saved = localStorage.getItem('cpp_subprograme_quiz1_progress');
            if (saved) {
                const data = JSON.parse(saved);
                totalXP = data.totalXP || 0;
                unlockedLevels = data.unlockedLevels || [1];
                levelScores = data.levelScores || {};
                updateXPDisplay();
                updateLevelMap();
            }
        }

        function saveProgress() {
            localStorage.setItem('cpp_subprograme_quiz1_progress', JSON.stringify({
                totalXP,
                unlockedLevels,
                levelScores
            }));
        }

        function updateXPDisplay() {
            document.getElementById('totalXP').textContent = totalXP;
        }

        function updateLevelMap() {
            document.querySelectorAll('.level-node').forEach((node, index) => {
                const level = index + 1;
                node.classList.remove('locked', 'active', 'completed');

                if (levelScores[level] !== undefined) {
                    node.classList.add('completed');
                } else if (unlockedLevels.includes(level)) {
                    if (level === Math.max(...unlockedLevels.filter(l => levelScores[l] === undefined))) {
                        node.classList.add('active');
                    }
                } else {
                    node.classList.add('locked');
                }
            });

            document.querySelectorAll('.level-connector').forEach((conn, index) => {
                if (levelScores[index + 1] !== undefined) {
                    conn.classList.add('completed');
                } else {
                    conn.classList.remove('completed');
                }
            });
        }

        function selectLevel(level) {
            if (!unlockedLevels.includes(level)) return;
            currentLevel = level;
            currentQuestion = 0;
            score = 0;
            showLevelIntro();
        }

        function showLevelIntro() {
            const levelData = levels[currentLevel];
            document.getElementById('quizArea').innerHTML = `
                <div class="level-intro">
                    <h2>${levelData.title}</h2>
                    <p>${levelData.description}</p>
                    <div class="xp-reward">+${levelData.xpReward} XP</div>
                    <button class="btn btn-primary" onclick="startLevel()">
                        Incepe Nivelul
                    </button>
                </div>
            `;
        }

        function startLevel() {
            showQuestion();
        }

        function showQuestion() {
            const levelData = levels[currentLevel];
            const q = levelData.questions[currentQuestion];

            let progressDots = '';
            for (let i = 0; i < levelData.questions.length; i++) {
                let dotClass = 'progress-dot';
                if (i === currentQuestion) dotClass += ' current';
                progressDots += `<div class="${dotClass}"></div>`;
            }

            let questionContent = `<p class="question-text">${q.text}</p>`;

            // Add code block if needed
            if (q.hasCode) {
                questionContent += `
                    <div class="code-block">
                        ${q.codeContent}
                    </div>
                `;
            }

            let optionsHTML = '';
            q.options.forEach((opt, i) => {
                optionsHTML += `<div class="option" onclick="selectAnswer(${i})">${opt}</div>`;
            });

            document.getElementById('quizArea').innerHTML = `
                <div class="question-container active">
                    <div class="question-progress">${progressDots}</div>
                    ${questionContent}
                    <div class="options-grid">${optionsHTML}</div>
                    <div class="feedback-box" id="feedback"></div>
                    <div style="text-align: center; margin-top: 1.5rem;">
                        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">
                            Urmatoarea Intrebare
                        </button>
                    </div>
                </div>
            `;
        }

        function selectAnswer(index) {
            const levelData = levels[currentLevel];
            const q = levelData.questions[currentQuestion];
            const options = document.querySelectorAll('.option');
            const feedback = document.getElementById('feedback');
            const nextBtn = document.getElementById('nextBtn');

            // Disable all options
            options.forEach(opt => opt.style.pointerEvents = 'none');

            // Show correct/wrong
            options[index].classList.add(index === q.correct ? 'correct' : 'wrong');
            if (index !== q.correct) {
                options[q.correct].classList.add('correct');
            }

            // Update progress dots
            const dots = document.querySelectorAll('.progress-dot');
            dots[currentQuestion].classList.remove('current');
            dots[currentQuestion].classList.add(index === q.correct ? 'correct' : 'wrong');

            // Show feedback
            if (index === q.correct) {
                score++;
                feedback.className = 'feedback-box show correct';
                feedback.innerHTML = `
                    <div class="feedback-icon">&#127881;</div>
                    <div class="feedback-text">Corect! Excelent!</div>
                    <div class="explanation">${q.explanation}</div>
                `;
            } else {
                feedback.className = 'feedback-box show wrong';
                feedback.innerHTML = `
                    <div class="feedback-icon">&#128161;</div>
                    <div class="feedback-text">Nu chiar... Hai sa intelegem de ce!</div>
                    <div class="explanation">${q.explanation}</div>
                `;
            }

            nextBtn.style.display = 'inline-flex';
            nextBtn.textContent = currentQuestion < levelData.questions.length - 1 ?
                'Urmatoarea Intrebare' : 'Vezi Rezultatul';
        }

        function nextQuestion() {
            const levelData = levels[currentLevel];
            currentQuestion++;

            if (currentQuestion >= levelData.questions.length) {
                showLevelComplete();
            } else {
                showQuestion();
            }
        }

        function showLevelComplete() {
            const levelData = levels[currentLevel];
            const percentage = Math.round((score / levelData.questions.length) * 100);
            const passed = percentage >= 66;

            let stars = '';
            if (percentage >= 100) stars = '&#11088;&#11088;&#11088;';
            else if (percentage >= 80) stars = '&#11088;&#11088;';
            else if (percentage >= 66) stars = '&#11088;';
            else stars = '&#128170;';

            let earnedXP = 0;
            if (passed) {
                earnedXP = levelData.xpReward;
                if (percentage === 100) earnedXP = Math.round(earnedXP * 1.5);

                if (!levelScores[currentLevel] || levelScores[currentLevel] < percentage) {
                    if (!levelScores[currentLevel]) {
                        totalXP += earnedXP;
                    }
                    levelScores[currentLevel] = percentage;
                }

                // Unlock next level
                if (currentLevel < 5 && !unlockedLevels.includes(currentLevel + 1)) {
                    unlockedLevels.push(currentLevel + 1);
                }

                saveProgress();
                updateXPDisplay();
                updateLevelMap();
            }

            document.getElementById('quizArea').innerHTML = `
                <div class="level-complete show">
                    <div class="level-complete-icon">${passed ? '&#127942;' : '&#128218;'}</div>
                    <h2>${passed ? 'Nivel Completat!' : 'Mai incearca!'}</h2>
                    <div class="stars">${stars}</div>
                    <div class="score-display">${score}/${levelData.questions.length} raspunsuri corecte (${percentage}%)</div>
                    ${passed ? `<div class="xp-earned">+${earnedXP} XP</div>` : ''}
                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-outline" onclick="selectLevel(${currentLevel})">
                            Reincearca
                        </button>
                        ${passed && currentLevel < 5 ? `
                            <button class="btn btn-primary" onclick="selectLevel(${currentLevel + 1})">
                                Nivelul Urmator
                            </button>
                        ` : ''}
                        ${passed && currentLevel === 5 ? `
                            <button class="btn btn-success" onclick="window.location.href='quiz2-declarare.html'">
                                Quiz-ul 2: Declararea functiilor
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // Initialize
        loadProgress();
        showLevelIntro();
    </script>
</body>
</html>
