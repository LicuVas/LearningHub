<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz: Pregatire Evaluare Nationala | Clasa 8</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f0f1a;
            --bg-secondary: #1a1a2e;
            --bg-card: #252540;
            --accent-red: #ef4444;
            --accent-rose: #f43f5e;
            --accent-green: #10b981;
            --accent-cyan: #06b6d4;
            --accent-yellow: #fbbf24;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #3d3d5c;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-radius: 16px;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
        }

        .quiz-title {
            font-size: 1.3rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-red), var(--accent-rose));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .xp-display {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, var(--accent-red), var(--accent-rose));
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            color: #fff;
        }

        .level-map {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .level-node {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            border: 3px solid var(--border);
            background: var(--bg-card);
        }

        .level-node.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .level-node.locked::after {
            content: 'üîí';
            position: absolute;
            font-size: 1rem;
            bottom: -5px;
            right: -5px;
        }

        .level-node.active {
            border-color: var(--accent-red);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
            animation: pulse 2s infinite;
        }

        .level-node.completed {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
            border-color: var(--accent-green);
        }

        .level-node.completed::after {
            content: '‚úì';
            position: absolute;
            font-size: 0.8rem;
            bottom: -5px;
            right: -5px;
            background: var(--accent-green);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .level-connector {
            width: 30px;
            height: 3px;
            background: var(--border);
            align-self: center;
        }

        .level-connector.completed {
            background: var(--accent-green);
        }

        .quiz-area {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid var(--border);
            min-height: 400px;
        }

        .level-intro {
            text-align: center;
            padding: 2rem;
        }

        .level-intro h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--accent-red);
        }

        .level-intro p {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .level-intro .xp-reward {
            display: inline-block;
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            margin-bottom: 2rem;
        }

        .question-container {
            display: none;
        }

        .question-container.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .question-progress {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--border);
        }

        .progress-dot.current {
            background: var(--accent-red);
        }

        .progress-dot.correct {
            background: var(--accent-green);
        }

        .progress-dot.wrong {
            background: var(--accent-red);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            text-align: center;
            line-height: 1.6;
        }

        .exam-tip {
            background: rgba(251, 191, 36, 0.1);
            border: 2px solid var(--accent-yellow);
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem auto;
            max-width: 500px;
        }

        .exam-tip-title {
            color: var(--accent-yellow);
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .exam-tip-content {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .options-grid {
            display: grid;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .option {
            padding: 1.2rem 1.5rem;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
            text-align: left;
        }

        .option:hover {
            border-color: var(--accent-rose);
            transform: translateX(5px);
        }

        .option.correct {
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.2);
        }

        .option.wrong {
            border-color: var(--accent-red);
            background: rgba(239, 68, 68, 0.2);
        }

        .feedback-box {
            display: none;
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 1.5rem;
            text-align: center;
        }

        .feedback-box.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .feedback-box.correct {
            background: rgba(16, 185, 129, 0.2);
            border: 2px solid var(--accent-green);
        }

        .feedback-box.wrong {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid var(--accent-red);
        }

        .feedback-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .feedback-text {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .explanation {
            font-size: 0.95rem;
            color: var(--text-secondary);
            background: var(--bg-card);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-red), var(--accent-rose));
            color: white;
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-secondary);
        }

        .btn-outline:hover {
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .level-complete {
            display: none;
            text-align: center;
            padding: 3rem;
        }

        .level-complete.show {
            display: block;
            animation: celebrate 0.5s ease;
        }

        @keyframes celebrate {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .level-complete-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        .level-complete h2 {
            font-size: 2rem;
            color: var(--accent-green);
            margin-bottom: 1rem;
        }

        .xp-earned {
            font-size: 2rem;
            color: var(--accent-red);
            margin: 1.5rem 0;
        }

        .score-display {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .stars {
            font-size: 3rem;
            margin: 1rem 0;
        }

        .final-message {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(244, 63, 94, 0.1));
            border: 2px solid var(--accent-rose);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .final-message h3 {
            color: var(--accent-rose);
            margin-bottom: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .back-link:hover {
            color: var(--accent-cyan);
        }

        @media (max-width: 600px) {
            .container { padding: 1rem; }
            .quiz-header { flex-direction: column; gap: 1rem; }
            .level-node { width: 50px; height: 50px; font-size: 1.2rem; }
            .question-text { font-size: 1.1rem; }
        }

        footer {
            margin-top: 3rem;
            padding: 1.5rem;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.85rem;
            border-top: 1px solid var(--border);
        }
    </style>
    <link rel="stylesheet" href="../../../../../assets/css/mobile.css">
    <link rel="stylesheet" href="../../../../../assets/css/mobile-first.css">
    </head>
<body>
    <a href="#main-content" class="skip-link">Sari la continut</a>
    <div id="main-content" class="container">
        <a href="../index.html" class="back-link">‚Üê Inapoi la Modulul 5</a>

        <div class="quiz-header">
            <div class="quiz-title">Quiz: Pregatire Evaluare Nationala</div>
            <div class="xp-display">
                <span>XP:</span>
                <span id="totalXP">0</span>
            </div>
        </div>

        <div class="level-map">
            <div class="level-node active" data-level="1" onclick="selectLevel(1)">1</div>
            <div class="level-connector"></div>
            <div class="level-node locked" data-level="2" onclick="selectLevel(2)">2</div>
            <div class="level-connector"></div>
            <div class="level-node locked" data-level="3" onclick="selectLevel(3)">3</div>
            <div class="level-connector"></div>
            <div class="level-node locked" data-level="4" onclick="selectLevel(4)">4</div>
            <div class="level-connector"></div>
            <div class="level-node locked" data-level="5" onclick="selectLevel(5)">5</div>
        </div>

        <div class="quiz-area" id="quizArea">
        </div>
    </div>

    <footer>
        <strong>&copy; 2026 Prof. Gurlan Vasile</strong><br>
        Informatica si TIC | <a href="mailto:grlnvasile@gmail.com" style="color: var(--accent-cyan);">grlnvasile@gmail.com</a>
    </footer>

    <script>
        const levels = {
            1: {
                title: "Nivel 1: Tipuri de Subiecte",
                description: "Intelegerea structurii si tipurilor de intrebari la evaluare",
                xpReward: 50,
                questions: [
                    {
                        text: "Ce tip de intrebare cere identificarea REZULTATULUI unui algoritm?",
                        options: [
                            "Intrebare de definire",
                            "Intrebare de urmarire pas cu pas (trace)",
                            "Intrebare de proiectare",
                            "Intrebare de comparare"
                        ],
                        correct: 1,
                        explanation: "Intrebarile de 'trace' (urmarire) cer sa executi mental algoritmul pas cu pas si sa determini ce valori au variabilele sau ce se afiseaza. STRATEGIE: Scrie valorile variabilelor la fiecare pas!"
                    },
                    {
                        text: "La evaluare, ce strategie folosim pentru intrebarile cu algoritmi?",
                        options: [
                            "Ghicim rapid si trecem mai departe",
                            "Simulam executia pas cu pas, notand valorile variabilelor",
                            "Citim doar prima si ultima linie",
                            "Alegem intotdeauna prima varianta"
                        ],
                        correct: 1,
                        explanation: "ESENTIAL: Simuleaza algoritmul ca un calculator! Scrie pe ciorna valorile variabilelor dupa fiecare instructiune. Nu sari peste pasi - greselile apar din graba!"
                    },
                    {
                        text: "Ce trebuie sa verifici INTOTDEAUNA inainte de a raspunde la o intrebare?",
                        options: [
                            "Cati colegi au terminat",
                            "Ce cere EXACT intrebarea (valoarea variabilei, ce se afiseaza, etc.)",
                            "Daca intrebarea e grea sau usoara",
                            "Cate minute au trecut"
                        ],
                        correct: 1,
                        explanation: "Citeste ATENT ce se cere! 'Ce valoare are x?' e diferit de 'Ce se afiseaza?'. Multi pierd puncte pentru ca raspund la altceva decat ce cere intrebarea."
                    }
                ]
            },
            2: {
                title: "Nivel 2: Algoritmi - Intrebari Tip",
                description: "Exercitii cu algoritmi similare celor de la evaluare",
                xpReward: 75,
                questions: [
                    {
                        text: "Ce afiseaza algoritmul?\n\nx = 7\ny = 3\nwhile x > y:\n    x = x - 2\n    y = y + 1\nprint(x, y)",
                        options: [
                            "7 3",
                            "5 4",
                            "3 5",
                            "1 6"
                        ],
                        correct: 2,
                        explanation: "Pas 1: x=7, y=3 (7>3 TRUE) -> x=5, y=4. Pas 2: x=5, y=4 (5>4 TRUE) -> x=3, y=5. Pas 3: x=3, y=5 (3>5 FALSE) -> STOP. Afiseaza: 3 5. TIP: Scrie un tabel cu valorile!"
                    },
                    {
                        text: "Cate numere afiseaza bucla?\n\nfor i in range(1, 10, 2):\n    print(i)",
                        options: [
                            "10 numere",
                            "5 numere",
                            "4 numere",
                            "9 numere"
                        ],
                        correct: 1,
                        explanation: "range(1, 10, 2): start=1, stop=10 (exclusiv), pas=2. Valori: 1, 3, 5, 7, 9 = 5 numere. Formula rapida: (stop-start)/pas rotunjit in sus. TIP: Scrie secventa pe ciorna!"
                    },
                    {
                        text: "Ce valoare are 's' la final?\n\ns = 0\nfor i in range(1, 4):\n    s = s + i * i\nprint(s)",
                        options: [
                            "6",
                            "9",
                            "14",
                            "10"
                        ],
                        correct: 2,
                        explanation: "range(1,4) = 1, 2, 3. i=1: s=0+1*1=1. i=2: s=1+2*2=5. i=3: s=5+3*3=14. Rezultat: 14. ATENTIE la ordinea operatiilor si la faptul ca range(1,4) NU include 4!"
                    }
                ]
            },
            3: {
                title: "Nivel 3: Baze de Date - Intrebari Tip",
                description: "Exercitii SQL similare celor de la evaluare",
                xpReward: 100,
                questions: [
                    {
                        text: "Avem tabelul Produse(ID, Nume, Pret, Cantitate). Ce returneaza:\nSELECT COUNT(*) FROM Produse WHERE Pret > 100;",
                        options: [
                            "Lista produselor scumpe",
                            "Numarul de produse cu pretul mai mare de 100",
                            "Suma preturilor",
                            "Pretul maxim"
                        ],
                        correct: 1,
                        explanation: "COUNT(*) NUMARA cate randuri indeplinesc conditia. WHERE Pret > 100 filtreaza doar produsele scumpe. Rezultat: un singur NUMAR (cate produse costa peste 100)."
                    },
                    {
                        text: "Ce face interogarea:\nSELECT Nume, Pret FROM Produse ORDER BY Pret DESC LIMIT 3;",
                        options: [
                            "Afiseaza primele 3 produse din tabel",
                            "Afiseaza cele mai SCUMPE 3 produse (nume si pret)",
                            "Afiseaza cele mai IEFTINE 3 produse",
                            "Sterge 3 produse"
                        ],
                        correct: 1,
                        explanation: "ORDER BY Pret DESC = sorteaza dupa pret DESCRESCATOR (cel mai mare primul). LIMIT 3 = ia doar primele 3. Rezultat: TOP 3 cele mai scumpe produse."
                    },
                    {
                        text: "Care interogare afiseaza CORECT produsele cu pretul intre 50 si 100?",
                        options: [
                            "SELECT * FROM Produse WHERE Pret > 50 OR Pret < 100;",
                            "SELECT * FROM Produse WHERE Pret >= 50 AND Pret <= 100;",
                            "SELECT * FROM Produse WHERE Pret = 50-100;",
                            "SELECT * FROM Produse WHERE Pret BETWEEN (50, 100);"
                        ],
                        correct: 1,
                        explanation: "Pentru 'intre X si Y' folosim AND cu ambele conditii: Pret >= 50 AND Pret <= 100. SAU: WHERE Pret BETWEEN 50 AND 100 (fara paranteze!). OR ar da TOATE produsele!"
                    }
                ]
            },
            4: {
                title: "Nivel 4: HTML/CSS - Intrebari Tip",
                description: "Exercitii web similare celor de la evaluare",
                xpReward: 125,
                questions: [
                    {
                        text: "Ce afiseaza browserul pentru codul:\n&lt;p style='color:blue; font-size:20px;'&gt;Test&lt;/p&gt;",
                        options: [
                            "Cuvantul 'Test' cu font albastru de 20 pixeli",
                            "Cuvantul 'Test' cu fundal albastru",
                            "Eroare de sintaxa",
                            "Nimic, codul e gresit"
                        ],
                        correct: 0,
                        explanation: "CSS inline (style='...') se aplica direct elementului. color:blue = text albastru, font-size:20px = dimensiune 20 pixeli. Rezultat: 'Test' albastru, marime 20px."
                    },
                    {
                        text: "Care selector CSS se aplica TUTUROR elementelor cu class='important'?",
                        options: [
                            "#important { }",
                            ".important { }",
                            "important { }",
                            "*important { }"
                        ],
                        correct: 1,
                        explanation: "PUNCT (.) = selector de CLASA. #=ID (unic), fara prefix=tag HTML. Deci .important {} selecteaza TOATE elementele cu class='important'. TIP de examen: confuzia . vs # e foarte frecventa!"
                    },
                    {
                        text: "Ce proprietate CSS face un element INVIZIBIL dar pastreaza spatiul ocupat?",
                        options: [
                            "display: none;",
                            "visibility: hidden;",
                            "opacity: 0;",
                            "hidden: true;"
                        ],
                        correct: 1,
                        explanation: "visibility: hidden = invizibil DAR pastreaza spatiul. display: none = dispare complet (nu ocupa spatiu). opacity: 0 = transparent (tot invizibil, pastreaza spatiu). 'hidden: true' NU exista in CSS."
                    }
                ]
            },
            5: {
                title: "Nivel 5: Strategii de Examen",
                description: "Sfaturi si trucuri pentru evaluarea nationala",
                xpReward: 150,
                questions: [
                    {
                        text: "Care este ordinea RECOMANDATA pentru rezolvarea subiectelor la evaluare?",
                        options: [
                            "Intotdeauna in ordine, de la 1 la final",
                            "Intai cele usoare/sigure, apoi cele grele",
                            "Intai cele grele ca sa scapi de ele",
                            "Aleatoriu"
                        ],
                        correct: 1,
                        explanation: "STRATEGIA CORECTA: 1) Rezolva RAPID ce stii sigur. 2) Revino la cele grele cu timpul ramas. 3) NU bloca 20 minute pe o intrebare! Asa maximizezi punctajul si reduci stresul."
                    },
                    {
                        text: "Ce faci daca nu stii raspunsul la o intrebare grila?",
                        options: [
                            "O lasi necompletata",
                            "Elimini variantele evident gresite si ghicesti dintre cele ramase",
                            "Alegi intotdeauna varianta B",
                            "Intrebi colegul"
                        ],
                        correct: 1,
                        explanation: "ELIMINAREA: Daca din 4 variante elimini 2 gresite, ai 50% sansa in loc de 25%! Niciodata nu lasa necompletat la grile - nu se scad puncte pentru raspuns gresit la majoritatea examenlor."
                    },
                    {
                        text: "Care este cel mai important sfat pentru intrebarile cu algoritmi?",
                        options: [
                            "Sa memorezi cat mai multi algoritmi",
                            "Sa faci TRACE (urmarirea pas cu pas) pe ciorna, scriind valorile",
                            "Sa te bazezi pe intuitie",
                            "Sa te uiti la raspunsuri si sa alegi cel mai logic"
                        ],
                        correct: 1,
                        explanation: "TRACE PE CIORNA este cheia! Scrie un tabel cu variabilele si valorile lor dupa FIECARE instructiune. Creierul face greseli la calcul mental - scrisul te salveaza de erori!"
                    }
                ]
            }
        };

        let currentLevel = 1;
        let currentQuestion = 0;
        let score = 0;
        let totalXP = 0;
        let levelScores = {};
        let unlockedLevels = [1];

        function loadProgress() {
            const saved = localStorage.getItem('cls8_quiz_evaluare_progress');
            if (saved) {
                const data = JSON.parse(saved);
                totalXP = data.totalXP || 0;
                unlockedLevels = data.unlockedLevels || [1];
                levelScores = data.levelScores || {};
                updateXPDisplay();
                updateLevelMap();
            }
        }

        function saveProgress() {
            localStorage.setItem('cls8_quiz_evaluare_progress', JSON.stringify({
                totalXP,
                unlockedLevels,
                levelScores
            }));
        }

        function updateXPDisplay() {
            document.getElementById('totalXP').textContent = totalXP;
        }

        function updateLevelMap() {
            document.querySelectorAll('.level-node').forEach((node, index) => {
                const level = index + 1;
                node.classList.remove('locked', 'active', 'completed');

                if (levelScores[level] !== undefined) {
                    node.classList.add('completed');
                } else if (unlockedLevels.includes(level)) {
                    if (level === Math.max(...unlockedLevels.filter(l => levelScores[l] === undefined))) {
                        node.classList.add('active');
                    }
                } else {
                    node.classList.add('locked');
                }
            });

            document.querySelectorAll('.level-connector').forEach((conn, index) => {
                if (levelScores[index + 1] !== undefined) {
                    conn.classList.add('completed');
                } else {
                    conn.classList.remove('completed');
                }
            });
        }

        function selectLevel(level) {
            if (!unlockedLevels.includes(level)) return;
            currentLevel = level;
            currentQuestion = 0;
            score = 0;
            showLevelIntro();
        }

        function showLevelIntro() {
            const levelData = levels[currentLevel];
            document.getElementById('quizArea').innerHTML = `
                <div class="level-intro">
                    <h2>${levelData.title}</h2>
                    <p>${levelData.description}</p>
                    <div class="xp-reward">+${levelData.xpReward} XP</div>
                    <button class="btn btn-primary" onclick="startLevel()">
                        Incepe Nivelul
                    </button>
                </div>
            `;
        }

        function startLevel() {
            showQuestion();
        }

        function showQuestion() {
            const levelData = levels[currentLevel];
            const q = levelData.questions[currentQuestion];

            let progressDots = '';
            for (let i = 0; i < levelData.questions.length; i++) {
                let dotClass = 'progress-dot';
                if (i === currentQuestion) dotClass += ' current';
                progressDots += `<div class="${dotClass}"></div>`;
            }

            let questionContent = `<p class="question-text">${q.text}</p>`;

            let optionsHTML = '';
            q.options.forEach((opt, i) => {
                optionsHTML += `<div class="option" onclick="selectAnswer(${i})">${opt}</div>`;
            });

            document.getElementById('quizArea').innerHTML = `
                <div class="question-container active">
                    <div class="question-progress">${progressDots}</div>
                    ${questionContent}
                    <div class="options-grid">${optionsHTML}</div>
                    <div class="feedback-box" id="feedback"></div>
                    <div style="text-align: center; margin-top: 1.5rem;">
                        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">
                            Urmatoarea Intrebare
                        </button>
                    </div>
                </div>
            `;
        }

        function selectAnswer(index) {
            const levelData = levels[currentLevel];
            const q = levelData.questions[currentQuestion];
            const options = document.querySelectorAll('.option');
            const feedback = document.getElementById('feedback');
            const nextBtn = document.getElementById('nextBtn');

            options.forEach(opt => opt.style.pointerEvents = 'none');

            options[index].classList.add(index === q.correct ? 'correct' : 'wrong');
            if (index !== q.correct) {
                options[q.correct].classList.add('correct');
            }

            const dots = document.querySelectorAll('.progress-dot');
            dots[currentQuestion].classList.remove('current');
            dots[currentQuestion].classList.add(index === q.correct ? 'correct' : 'wrong');

            if (index === q.correct) {
                score++;
                feedback.className = 'feedback-box show correct';
                feedback.innerHTML = `
                    <div class="feedback-icon">üéâ</div>
                    <div class="feedback-text">Corect! Excelent!</div>
                    <div class="explanation">${q.explanation}</div>
                `;
            } else {
                feedback.className = 'feedback-box show wrong';
                feedback.innerHTML = `
                    <div class="feedback-icon">üí°</div>
                    <div class="feedback-text">Nu este raspunsul corect. Iata explicatia:</div>
                    <div class="explanation">${q.explanation}</div>
                `;
            }

            nextBtn.style.display = 'inline-flex';
            nextBtn.textContent = currentQuestion < levelData.questions.length - 1 ?
                'Urmatoarea Intrebare' : 'Vezi Rezultatul';
        }

        function nextQuestion() {
            const levelData = levels[currentLevel];
            currentQuestion++;

            if (currentQuestion >= levelData.questions.length) {
                showLevelComplete();
            } else {
                showQuestion();
            }
        }

        function showLevelComplete() {
            const levelData = levels[currentLevel];
            const percentage = Math.round((score / levelData.questions.length) * 100);
            const passed = percentage >= 66;

            let stars = '';
            if (percentage >= 100) stars = '‚≠ê‚≠ê‚≠ê';
            else if (percentage >= 80) stars = '‚≠ê‚≠ê';
            else if (percentage >= 66) stars = '‚≠ê';
            else stars = 'üí™';

            let earnedXP = 0;
            if (passed) {
                earnedXP = levelData.xpReward;
                if (percentage === 100) earnedXP = Math.round(earnedXP * 1.5);

                if (!levelScores[currentLevel] || levelScores[currentLevel] < percentage) {
                    if (!levelScores[currentLevel]) {
                        totalXP += earnedXP;
                    }
                    levelScores[currentLevel] = percentage;
                }

                if (currentLevel < 5 && !unlockedLevels.includes(currentLevel + 1)) {
                    unlockedLevels.push(currentLevel + 1);
                }

                saveProgress();
                updateXPDisplay();
                updateLevelMap();
            }

            let finalMessage = '';
            if (passed && currentLevel === 5) {
                finalMessage = `
                    <div class="final-message">
                        <h3>Felicitari! Ai terminat toate quiz-urile de recapitulare!</h3>
                        <p>Esti pregatit pentru evaluarea nationala. Succes!</p>
                        <p style="margin-top: 1rem;"><strong>Retine:</strong> Citeste atent, fa trace pe ciorna, verifica raspunsurile!</p>
                    </div>
                `;
            }

            document.getElementById('quizArea').innerHTML = `
                <div class="level-complete show">
                    <div class="level-complete-icon">${passed ? 'üèÜ' : 'üìö'}</div>
                    <h2>${passed ? 'Nivel Completat!' : 'Mai incearca!'}</h2>
                    <div class="stars">${stars}</div>
                    <div class="score-display">${score}/${levelData.questions.length} raspunsuri corecte (${percentage}%)</div>
                    ${passed ? `<div class="xp-earned">+${earnedXP} XP</div>` : ''}
                    ${finalMessage}
                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-outline" onclick="selectLevel(${currentLevel})">
                            Reincearca
                        </button>
                        ${passed && currentLevel < 5 ? `
                            <button class="btn btn-primary" onclick="selectLevel(${currentLevel + 1})">
                                Nivelul Urmator
                            </button>
                        ` : ''}
                        ${passed && currentLevel === 5 ? `
                            <button class="btn btn-success" onclick="window.location.href='../index.html'">
                                Inapoi la Modul
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        loadProgress();
        showLevelIntro();
    </script>
</body>
</html>
